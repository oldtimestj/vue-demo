{"remainingRequest":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tongjie/Desktop/VueProject/vuecli4-demo/src/components/PlPopoverWord.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/src/components/PlPopoverWord.vue","mtime":1591939319760},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAnbG9kYXNoJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUGxQb3BvdmVyV29yZCcsCiAgcHJvcHM6IHsKICAgIGxpbmU6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAxLAogICAgfSwKICAgIGNvbnRlbnQ6IFN0cmluZywKICAgIGxlbmd0aDogTnVtYmVyLAogICAgcGxhY2VtZW50OiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3RvcCcsCiAgICB9LAogICAgdHJpZ2dlcjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdob3ZlcicsCiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzSW5pdDogZmFsc2UsCiAgICAgIGRpc2FibGVkOiB0cnVlLAogICAgICBjb250YWluZXJNYXhIZWlnaHQ6ICdpbmhlcml0JywKICAgICAgdDogMCwKICAgICAgYWJjOiBmYWxzZSwKICAgICAgY1dpZHRoOiAwLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmb3JtYXRDb250ZW50KCkgewogICAgICByZXR1cm4gYCR7dGhpcy5jb250ZW50IHx8ICcnfWAucmVwbGFjZSgvXHMvZywgJyZuYnNwOycpOwogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICBpZiAoIXRoaXMuaXNJbml0ICYmICF0aGlzLmxlbmd0aCkgewogICAgICB0aGlzLmlzSW5pdCA9IHRydWU7CiAgICAgIHRoaXMuc2V0RGlzYWJsZWREZWJvdW5jZSA9IGRlYm91bmNlKHRoaXMuc2V0RGlzYWJsZWQsIDUwMCk7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnNldERpc2FibGVkRGVib3VuY2UpOwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zZXREaXNhYmxlZERlYm91bmNlKTsKICAgIH0KICAgIHRoaXMuc2V0RGlzYWJsZWQoKTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLnQgJiYgY2xlYXJUaW1lb3V0KHRoaXMudCk7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zZXREaXNhYmxlZERlYm91bmNlKTsKICB9LAogIHdhdGNoOiB7CiAgICBjb250ZW50KCkgewogICAgICB0aGlzLnNldERpc2FibGVkKCk7CiAgICB9LAogICAgbGluZSgpIHsKICAgICAgdGhpcy5zZXREaXNhYmxlZCgpOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldENvbnRhaW5lckRvbSgpIHsKICAgICAgdGhpcy5jb250YWluZXJEb20gPSB0aGlzLmNvbnRhaW5lckRvbSB8fCB0aGlzLiRyZWZzLmNvbnRhaW5lcjsKICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyRG9tOwogICAgfSwKICAgIGdldENvbnRlbnREb20oKSB7CiAgICAgIHRoaXMuY29udGVudERvbSA9IHRoaXMuY29udGVudERvbSB8fCB0aGlzLiRyZWZzLmNvbnRlbnQ7CiAgICAgIHJldHVybiB0aGlzLmNvbnRlbnREb207CiAgICB9LAogICAgY2FsY0xlbmd0aCgpIHsKICAgICAgaWYgKHRoaXMubGVuZ3RoKSByZXR1cm4gdGhpcy5sZW5ndGg7CiAgICAgIGlmICh3aW5kb3cubmF2aWdhdG9yLm1zU2F2ZUJsb2IpIHsKICAgICAgICBjb25zdCBmb250U2l6ZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZ2V0Q29udGVudERvbSgpKS5mb250U2l6ZS5zcGxpdCgncHgnKVswXSAvIDI7CiAgICAgICAgY29uc3QgY29udGFpbmVyV2lkdGggPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmdldENvbnRhaW5lckRvbSgpKS53aWR0aC5zcGxpdCgncHgnKVswXSAqIDE7CiAgICAgICAgcmV0dXJuIChjb250YWluZXJXaWR0aCAvIGZvbnRTaXplKS50b0ZpeGVkKDApICogdGhpcy5saW5lICsgMTsKICAgICAgfQogICAgICBjb25zdCB7IHdpZHRoOiBjV2lkdGgsIGhlaWdodDogY0hlaWdodCB9ID0gdGhpcy5nZXRDb250ZW50RG9tKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gdGhpcy5nZXRDb250YWluZXJEb20oKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKHRoaXMubGluZSA+IDEpIHJldHVybiBjSGVpZ2h0ID4gaGVpZ2h0ID8gMCA6IEluZmluaXR5OwogICAgICByZXR1cm4gY1dpZHRoID4gd2lkdGggPyAwIDogSW5maW5pdHk7CiAgICB9LAogICAgY2FsY1N0ckxlbihzdHIpIHsKICAgICAgbGV0IGxlbiA9IDA7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgaWYgKHN0ci5jaGFyQ29kZUF0KGkpID4gMCAmJiBzdHIuY2hhckNvZGVBdChpKSA8IDEyOCkgbGVuICs9IDE7CiAgICAgICAgZWxzZSBsZW4gKz0gMjsKICAgICAgfQogICAgICByZXR1cm4gbGVuOwogICAgfSwKICAgIHNldERpc2FibGVkKCkgewogICAgICB0aGlzLnNldENvbnRhaW5lck1heEhlaWdodCgpOwogICAgICB0aGlzLnQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLmRpc2FibGVkID0gIXRoaXMuY29udGVudCB8fCB0aGlzLmNhbGNTdHJMZW4odGhpcy5jb250ZW50KSA8IHRoaXMuY2FsY0xlbmd0aCgpOwogICAgICB9LCAxMDApOwogICAgfSwKICAgIHNldENvbnRhaW5lck1heEhlaWdodCgpIHsKICAgICAgaWYgKCF0aGlzLmNvbnRlbnQgfHwgdGhpcy5saW5lIDw9IDEgfHwgIXRoaXMuZ2V0Q29udGVudERvbSgpKSByZXR1cm47CiAgICAgIHRoaXMuY29udGFpbmVyTWF4SGVpZ2h0ID0gYCR7d2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5nZXRDb250ZW50RG9tKCkpLmxpbmVIZWlnaHQuc3BsaXQoJ3B4JylbMF0gKiB0aGlzLmxpbmV9cHhgOwogICAgfSwKICAgIGNsaWNrQ29udGVudCgpIHsKICAgICAgdGhpcy4kZW1pdCgnY2xpY2snKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["PlPopoverWord.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PlPopoverWord.vue","sourceRoot":"src/components","sourcesContent":["<!--\nCreated by zhulixiao on 2020/5/7.\n-->\n<template>\n  <div class=\"pl-popover-word\">\n    <el-popover\n      :disabled=\"disabled\"\n      :trigger=\"trigger\"\n      :placement=\"placement\"\n      popper-class=\"pl-popover-word-reference\"\n      ref=\"pop\"\n    >\n      <p style=\"max-width: 300px\" slot v-html=\"formatContent\"></p>\n      <p\n        slot=\"reference\"\n        ref=\"container\"\n        :class=\"line > 1 ? 'ellipsis-lines' : 'ellipsis'\"\n        :style=\"{webkitLineClamp: this.line, maxHeight: containerMaxHeight}\"\n        style=\"height: inherit;\"\n      >\n        <span @click=\"clickContent\" ref=\"content\" v-html=\"formatContent\"></span>\n      </p>\n    </el-popover>\n  </div>\n</template>\n\n<script>\n  import { debounce } from 'lodash';\n\n  export default {\n    name: 'PlPopoverWord',\n    props: {\n      line: {\n        type: Number,\n        default: 1,\n      },\n      content: String,\n      length: Number,\n      placement: {\n        type: String,\n        default: 'top',\n      },\n      trigger: {\n        type: String,\n        default: 'hover',\n      },\n    },\n    data() {\n      return {\n        isInit: false,\n        disabled: true,\n        containerMaxHeight: 'inherit',\n        t: 0,\n        abc: false,\n        cWidth: 0,\n      };\n    },\n    computed: {\n      formatContent() {\n        return `${this.content || ''}`.replace(/\\s/g, '&nbsp;');\n      },\n    },\n    mounted() {\n      if (!this.isInit && !this.length) {\n        this.isInit = true;\n        this.setDisabledDebounce = debounce(this.setDisabled, 500);\n        window.removeEventListener('resize', this.setDisabledDebounce);\n        window.addEventListener('resize', this.setDisabledDebounce);\n      }\n      this.setDisabled();\n    },\n    beforeDestroy() {\n      this.t && clearTimeout(this.t);\n      window.removeEventListener('resize', this.setDisabledDebounce);\n    },\n    watch: {\n      content() {\n        this.setDisabled();\n      },\n      line() {\n        this.setDisabled();\n      },\n    },\n    methods: {\n      getContainerDom() {\n        this.containerDom = this.containerDom || this.$refs.container;\n        return this.containerDom;\n      },\n      getContentDom() {\n        this.contentDom = this.contentDom || this.$refs.content;\n        return this.contentDom;\n      },\n      calcLength() {\n        if (this.length) return this.length;\n        if (window.navigator.msSaveBlob) {\n          const fontSize = window.getComputedStyle(this.getContentDom()).fontSize.split('px')[0] / 2;\n          const containerWidth = window.getComputedStyle(this.getContainerDom()).width.split('px')[0] * 1;\n          return (containerWidth / fontSize).toFixed(0) * this.line + 1;\n        }\n        const { width: cWidth, height: cHeight } = this.getContentDom().getBoundingClientRect();\n        const { width, height } = this.getContainerDom().getBoundingClientRect();\n        if (this.line > 1) return cHeight > height ? 0 : Infinity;\n        return cWidth > width ? 0 : Infinity;\n      },\n      calcStrLen(str) {\n        let len = 0;\n        for (let i = 0; i < str.length; i += 1) {\n          if (str.charCodeAt(i) > 0 && str.charCodeAt(i) < 128) len += 1;\n          else len += 2;\n        }\n        return len;\n      },\n      setDisabled() {\n        this.setContainerMaxHeight();\n        this.t = setTimeout(() => {\n          this.disabled = !this.content || this.calcStrLen(this.content) < this.calcLength();\n        }, 100);\n      },\n      setContainerMaxHeight() {\n        if (!this.content || this.line <= 1 || !this.getContentDom()) return;\n        this.containerMaxHeight = `${window.getComputedStyle(this.getContentDom()).lineHeight.split('px')[0] * this.line}px`;\n      },\n      clickContent() {\n        this.$emit('click');\n      },\n    },\n  };\n</script>\n\n<style lang=\"scss\" scoped>\n  .pl-popover-word {\n    padding: 0;\n    width: 100%;\n    overflow: hidden;\n    line-height: unset;\n    vertical-align: middle;\n  }\n  .ellipsis-lines {\n    white-space: normal;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n  }\n</style>\n"]}]}