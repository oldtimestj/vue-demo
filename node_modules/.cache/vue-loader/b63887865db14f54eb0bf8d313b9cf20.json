{"remainingRequest":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tongjie/Desktop/VueProject/vuecli4-demo/src/components/PlMenu/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/src/components/PlMenu/index.vue","mtime":1603074666019},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2gvZGVib3VuY2UnOwppbXBvcnQgTWVudVBhbmVsU21hbGwgZnJvbSAnQC9jb21wb25lbnRzL1BsTWVudS9NZW51UGFuZWxTbWFsbCc7CmltcG9ydCBNZW51UGFuZWxNZWRpdW0gZnJvbSAnQC9jb21wb25lbnRzL1BsTWVudS9NZW51UGFuZWxNZWRpdW0nOwppbXBvcnQgTWVudVBhbmVsTGFyZ2UgZnJvbSAnQC9jb21wb25lbnRzL1BsTWVudS9NZW51UGFuZWxMYXJnZSc7CmltcG9ydCBwcm9wcyBmcm9tICdAL2NvbXBvbmVudHMvUGxNZW51L3Byb3BzJzsKaW1wb3J0IE1lbnVJdGVtIGZyb20gJ0AvY29tcG9uZW50cy9QbE1lbnUvTWVudUl0ZW0nOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQbE1lbnUnLAogIGNvbXBvbmVudHM6IHsKICAgIE1lbnVJdGVtLCBNZW51UGFuZWxMYXJnZSwgTWVudVBhbmVsTWVkaXVtLCBNZW51UGFuZWxTbWFsbCwgCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YTogW10sCiAgICAgIGFjdGl2ZUl0ZW06IHt9LAogICAgICBhY3RpdmVJdGVtRG9tOiB7fSwKICAgIH07CiAgfSwKICBwcm9wcywKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuc2V0RGF0YURlYm91bmNlKTsKICAgIHRoaXMuJHJlZnMuc2Nyb2xsTGlzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLnNldERhdGFEZWJvdW5jZSk7CiAgfSwKICBjb21wdXRlZDogewogICAgY3VyTWVudSgpIHsKICAgICAgY29uc3QgY3VyTWVudSA9IHRoaXMuZGF0YS5maW5kKChvYmopID0+IHsKICAgICAgICBsZXQgYXJyID0gW29ial07CiAgICAgICAgd2hpbGUgKGFyci5sZW5ndGgpIHsKICAgICAgICAgIGNvbnN0IGFjdGl2ZU1lbnUgPSBhcnIuZmluZChpdGVtID0+IGl0ZW0ucm91dGVyID09PSB0aGlzLiRyb3V0ZS5wYXRoKTsKICAgICAgICAgIGlmIChhY3RpdmVNZW51KSByZXR1cm4gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHRlbXAgPSBhcnIubWFwKGl0ZW0gPT4gKHsgLi4uaXRlbSB9KSk7CiAgICAgICAgICBhcnIgPSB0ZW1wLmZpbHRlcihpdGVtID0+IGl0ZW0uY2hpbGRyZW4pCiAgICAgICAgICAgIC5yZWR1Y2UoKHRvdGFsLCBjdXIpID0+IFsuLi50b3RhbCwgLi4uY3VyLmNoaWxkcmVuXSwgW10pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pOwogICAgICByZXR1cm4gY3VyTWVudSB8fCB7fTsKICAgIH0sCiAgfSwKICB3YXRjaDogewogICAgbWVudVRyZWUoKSB7CiAgICAgIHRoaXMuaW5pdCgpOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXQoKSB7CiAgICAgIHRoaXMuc2V0RGF0YSh0aGlzLm1lbnVUcmVlKTsKICAgICAgdGhpcy5zZXREYXRhRGVib3VuY2UgPSBkZWJvdW5jZSgoKSA9PiB0aGlzLnNldERhdGEoKSwgMjAwKTsKICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuc2V0RGF0YURlYm91bmNlKTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuc2V0RGF0YURlYm91bmNlKTsKICAgICAgdGhpcy4kcmVmcy5zY3JvbGxMaXN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2V0RGF0YURlYm91bmNlKTsKICAgICAgdGhpcy4kcmVmcy5zY3JvbGxMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2V0RGF0YURlYm91bmNlKTsKICAgIH0sCiAgICBlbnRlck1lbnVJdGVtKGl0ZW0sIGRvbSkgewogICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSBpdGVtOwogICAgICB0aGlzLmFjdGl2ZUl0ZW1Eb20gPSBkb207CiAgICB9LAogICAgbGVhdmVNZW51SXRlbSgpIHsKICAgICAgLy8gdGhpcy5hY3RpdmVJdGVtID0ge307CiAgICB9LAogICAgc2V0Q3VyTWVudShpdGVtKSB7CiAgICAgIHRoaXMuY3VyTWVudSA9IHRoaXMuY3VyTWVudSB8fCBpdGVtOwogICAgfSwKICAgIHNldERhdGEoZGF0YSA9IHRoaXMubWVudVRyZWUpIHsKICAgICAgdGhpcy5kYXRhID0gZGF0YS5tYXAoaXRlbSA9PiAoewogICAgICAgIC4uLml0ZW0sCiAgICAgICAgZGVwdGg6IHRoaXMuZ2V0RGVwdGgoaXRlbSksCiAgICAgIH0pKTsKICAgICAgdGhpcy5hY3RpdmVJdGVtID0geyAuLi50aGlzLmFjdGl2ZUl0ZW0gfTsKICAgIH0sCiAgICBnZXREZXB0aChvYmopIHsKICAgICAgbGV0IGFyciA9IFtvYmpdOwogICAgICBsZXQgZGVwdGggPSAwOwogICAgICB3aGlsZSAoYXJyLmxlbmd0aCkgewogICAgICAgIGNvbnN0IHRlbXAgPSBhcnIubWFwKGl0ZW0gPT4gKHsgLi4uaXRlbSB9KSk7CiAgICAgICAgYXJyID0gdGVtcC5maWx0ZXIoaXRlbSA9PiBpdGVtLmNoaWxkcmVuKQogICAgICAgICAgLnJlZHVjZSgodG90YWwsIGN1cikgPT4gWy4uLnRvdGFsLCAuLi5jdXIuY2hpbGRyZW5dLCBbXSk7CiAgICAgICAgaWYgKGFyci5sZW5ndGgpIGRlcHRoICs9IDE7CiAgICAgIH0KICAgICAgcmV0dXJuIGRlcHRoOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/PlMenu","sourcesContent":["<!--\nCreated by zhulixiao on 2020/4/22.\n-->\n<template>\n  <div class=\"pl-menu\" @mouseleave=\"leaveMenuItem\">\n    <div ref=\"scrollList\" class=\"pl-menu-item__list\">\n      <div\n        v-for=\"(parentItem, parentIndex) in data\"\n        :key=\"parentItem.id\"\n        class=\"pl-submenu-item\"\n        :class=\"{'is-active': activeItem.id === parentItem.id || curMenu.id === parentItem.id}\"\n        @mouseenter=\"enterMenuItem(parentItem, $refs.parentItem[parentIndex])\"\n        ref=\"parentItem\"\n      >\n        <menu-item :menu-item=\"parentItem\"/>\n      </div>\n    </div>\n    <transition v-for=\"parentItem in data\" name=\"fade\" :key=\"parentItem.id\">\n      <div\n        v-if=\"activeItem.id && parentItem.id === activeItem.id && activeItemDom\"\n      >\n        <menu-panel-small\n          v-if=\"activeItem.depth === 1\"\n          :data=\"activeItem\"\n          :parentItem=\"activeItemDom\"\n        />\n        <menu-panel-medium\n          v-else-if=\"activeItem.depth === 2\"\n          :data=\"activeItem\"\n          :parentItem=\"activeItemDom\"\n        />\n        <menu-panel-large\n          v-else-if=\"activeItem.depth === 3\"\n          :data=\"activeItem\"\n          :parentItem=\"activeItemDom\"\n        />\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\n  import debounce from 'lodash/debounce';\n  import MenuPanelSmall from '@/components/PlMenu/MenuPanelSmall';\n  import MenuPanelMedium from '@/components/PlMenu/MenuPanelMedium';\n  import MenuPanelLarge from '@/components/PlMenu/MenuPanelLarge';\n  import props from '@/components/PlMenu/props';\n  import MenuItem from '@/components/PlMenu/MenuItem';\n\n  export default {\n    name: 'PlMenu',\n    components: {\n      MenuItem, MenuPanelLarge, MenuPanelMedium, MenuPanelSmall, \n    },\n    data() {\n      return {\n        data: [],\n        activeItem: {},\n        activeItemDom: {},\n      };\n    },\n    props,\n    mounted() {\n      this.init();\n    },\n    beforeDestroy() {\n      window.removeEventListener('resize', this.setDataDebounce);\n      this.$refs.scrollList.removeEventListener('scroll', this.setDataDebounce);\n    },\n    computed: {\n      curMenu() {\n        const curMenu = this.data.find((obj) => {\n          let arr = [obj];\n          while (arr.length) {\n            const activeMenu = arr.find(item => item.router === this.$route.path);\n            if (activeMenu) return true;\n            const temp = arr.map(item => ({ ...item }));\n            arr = temp.filter(item => item.children)\n              .reduce((total, cur) => [...total, ...cur.children], []);\n          }\n          return false;\n        });\n        return curMenu || {};\n      },\n    },\n    watch: {\n      menuTree() {\n        this.init();\n      },\n    },\n    methods: {\n      init() {\n        this.setData(this.menuTree);\n        this.setDataDebounce = debounce(() => this.setData(), 200);\n        window.removeEventListener('resize', this.setDataDebounce);\n        window.addEventListener('resize', this.setDataDebounce);\n        this.$refs.scrollList.removeEventListener('scroll', this.setDataDebounce);\n        this.$refs.scrollList.addEventListener('scroll', this.setDataDebounce);\n      },\n      enterMenuItem(item, dom) {\n        this.activeItem = item;\n        this.activeItemDom = dom;\n      },\n      leaveMenuItem() {\n        // this.activeItem = {};\n      },\n      setCurMenu(item) {\n        this.curMenu = this.curMenu || item;\n      },\n      setData(data = this.menuTree) {\n        this.data = data.map(item => ({\n          ...item,\n          depth: this.getDepth(item),\n        }));\n        this.activeItem = { ...this.activeItem };\n      },\n      getDepth(obj) {\n        let arr = [obj];\n        let depth = 0;\n        while (arr.length) {\n          const temp = arr.map(item => ({ ...item }));\n          arr = temp.filter(item => item.children)\n            .reduce((total, cur) => [...total, ...cur.children], []);\n          if (arr.length) depth += 1;\n        }\n        return depth;\n      },\n    },\n  };\n</script>\n<style lang=\"sass\">\n  @import './index.scss'\n</style>\n"]}]}