{"remainingRequest":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tongjie/Desktop/VueProject/vuecli4-demo/src/components/PlPopoverWord.vue?vue&type=style&index=0&id=54ba139a&lang=scss&scoped=true&","dependencies":[{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/src/components/PlPopoverWord.vue","mtime":1591939319760},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tongjie/Desktop/VueProject/vuecli4-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5wbC1wb3BvdmVyLXdvcmQgewogIHBhZGRpbmc6IDA7CiAgd2lkdGg6IDEwMCU7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKICBsaW5lLWhlaWdodDogdW5zZXQ7CiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKfQouZWxsaXBzaXMtbGluZXMgewogIHdoaXRlLXNwYWNlOiBub3JtYWw7CiAgZGlzcGxheTogLXdlYmtpdC1ib3g7CiAgLXdlYmtpdC1ib3gtb3JpZW50OiB2ZXJ0aWNhbDsKfQo="},{"version":3,"sources":["PlPopoverWord.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PlPopoverWord.vue","sourceRoot":"src/components","sourcesContent":["<!--\nCreated by zhulixiao on 2020/5/7.\n-->\n<template>\n  <div class=\"pl-popover-word\">\n    <el-popover\n      :disabled=\"disabled\"\n      :trigger=\"trigger\"\n      :placement=\"placement\"\n      popper-class=\"pl-popover-word-reference\"\n      ref=\"pop\"\n    >\n      <p style=\"max-width: 300px\" slot v-html=\"formatContent\"></p>\n      <p\n        slot=\"reference\"\n        ref=\"container\"\n        :class=\"line > 1 ? 'ellipsis-lines' : 'ellipsis'\"\n        :style=\"{webkitLineClamp: this.line, maxHeight: containerMaxHeight}\"\n        style=\"height: inherit;\"\n      >\n        <span @click=\"clickContent\" ref=\"content\" v-html=\"formatContent\"></span>\n      </p>\n    </el-popover>\n  </div>\n</template>\n\n<script>\n  import { debounce } from 'lodash';\n\n  export default {\n    name: 'PlPopoverWord',\n    props: {\n      line: {\n        type: Number,\n        default: 1,\n      },\n      content: String,\n      length: Number,\n      placement: {\n        type: String,\n        default: 'top',\n      },\n      trigger: {\n        type: String,\n        default: 'hover',\n      },\n    },\n    data() {\n      return {\n        isInit: false,\n        disabled: true,\n        containerMaxHeight: 'inherit',\n        t: 0,\n        abc: false,\n        cWidth: 0,\n      };\n    },\n    computed: {\n      formatContent() {\n        return `${this.content || ''}`.replace(/\\s/g, '&nbsp;');\n      },\n    },\n    mounted() {\n      if (!this.isInit && !this.length) {\n        this.isInit = true;\n        this.setDisabledDebounce = debounce(this.setDisabled, 500);\n        window.removeEventListener('resize', this.setDisabledDebounce);\n        window.addEventListener('resize', this.setDisabledDebounce);\n      }\n      this.setDisabled();\n    },\n    beforeDestroy() {\n      this.t && clearTimeout(this.t);\n      window.removeEventListener('resize', this.setDisabledDebounce);\n    },\n    watch: {\n      content() {\n        this.setDisabled();\n      },\n      line() {\n        this.setDisabled();\n      },\n    },\n    methods: {\n      getContainerDom() {\n        this.containerDom = this.containerDom || this.$refs.container;\n        return this.containerDom;\n      },\n      getContentDom() {\n        this.contentDom = this.contentDom || this.$refs.content;\n        return this.contentDom;\n      },\n      calcLength() {\n        if (this.length) return this.length;\n        if (window.navigator.msSaveBlob) {\n          const fontSize = window.getComputedStyle(this.getContentDom()).fontSize.split('px')[0] / 2;\n          const containerWidth = window.getComputedStyle(this.getContainerDom()).width.split('px')[0] * 1;\n          return (containerWidth / fontSize).toFixed(0) * this.line + 1;\n        }\n        const { width: cWidth, height: cHeight } = this.getContentDom().getBoundingClientRect();\n        const { width, height } = this.getContainerDom().getBoundingClientRect();\n        if (this.line > 1) return cHeight > height ? 0 : Infinity;\n        return cWidth > width ? 0 : Infinity;\n      },\n      calcStrLen(str) {\n        let len = 0;\n        for (let i = 0; i < str.length; i += 1) {\n          if (str.charCodeAt(i) > 0 && str.charCodeAt(i) < 128) len += 1;\n          else len += 2;\n        }\n        return len;\n      },\n      setDisabled() {\n        this.setContainerMaxHeight();\n        this.t = setTimeout(() => {\n          this.disabled = !this.content || this.calcStrLen(this.content) < this.calcLength();\n        }, 100);\n      },\n      setContainerMaxHeight() {\n        if (!this.content || this.line <= 1 || !this.getContentDom()) return;\n        this.containerMaxHeight = `${window.getComputedStyle(this.getContentDom()).lineHeight.split('px')[0] * this.line}px`;\n      },\n      clickContent() {\n        this.$emit('click');\n      },\n    },\n  };\n</script>\n\n<style lang=\"scss\" scoped>\n  .pl-popover-word {\n    padding: 0;\n    width: 100%;\n    overflow: hidden;\n    line-height: unset;\n    vertical-align: middle;\n  }\n  .ellipsis-lines {\n    white-space: normal;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n  }\n</style>\n"]}]}