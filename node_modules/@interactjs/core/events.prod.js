import*as e from"../utils/arr.prod.js";import*as t from"../utils/domUtils.prod.js";import s from"../utils/extend.prod.js";import n from"../utils/is.prod.js";import r from"../utils/pointerExtend.prod.js";import*as o from"../utils/pointerUtils.prod.js";class i{constructor(e){this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=e,r(this,e)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}function a(e){if(!n.object(e))return{capture:!!e,passive:!1};const t=s({},e);return t.capture=!!e.capture,t.passive=!!e.passive,t}export default{id:"events",install(s){const r=[],p={},l=[],c={add:u,remove:v,addDelegate(t,s,n,r,o){const i=a(o);if(!p[n]){p[n]=[];for(const e of l)u(e,n,d),u(e,n,f,!0)}const c=p[n];let v=e.find(c,e=>e.selector===t&&e.context===s);v||(v={selector:t,context:s,listeners:[]},c.push(v)),v.listeners.push([r,i])},removeDelegate(e,t,s,n,r){const o=a(r),i=p[s];let l,c=!1;if(i)for(l=i.length-1;l>=0;l--){const r=i[l];if(r.selector===e&&r.context===t){const{listeners:e}=r;for(let r=e.length-1;r>=0;r--){const[a,{capture:p,passive:u}]=e[r];if(a===n&&p===o.capture&&u===o.passive){e.splice(r,1),e.length||(i.splice(l,1),v(t,s,d),v(t,s,f,!0)),c=!0;break}}if(c)break}}},delegateListener:d,delegateUseCapture:f,delegatedEvents:p,documents:l,targets:r,supportsOptions:!1,supportsPassive:!1};function u(t,s,n,o){const i=a(o);let p=e.find(r,e=>e.eventTarget===t);p||(p={eventTarget:t,events:{}},r.push(p)),p.events[s]||(p.events[s]=[]),t.addEventListener&&!e.contains(p.events[s],n)&&(t.addEventListener(s,n,c.supportsOptions?i:i.capture),p.events[s].push(n))}function v(t,s,n,o){const i=a(o),p=e.findIndex(r,e=>e.eventTarget===t),l=r[p];if(!l||!l.events)return;if("all"===s){for(s in l.events)l.events.hasOwnProperty(s)&&v(t,s,"all");return}let u=!1;const d=l.events[s];if(d){if("all"===n){for(let e=d.length-1;e>=0;e--)v(t,s,d[e],i);return}for(let e=0;e<d.length;e++)if(d[e]===n){t.removeEventListener(s,n,c.supportsOptions?i:i.capture),d.splice(e,1),0===d.length&&(delete l.events[s],u=!0);break}}u&&!Object.keys(l.events).length&&r.splice(p,1)}function d(e,s){const r=a(s),l=new i(e),c=p[e.type],[u]=o.getEventTargets(e);let v=u;for(;n.element(v);){for(let e=0;e<c.length;e++){const s=c[e],{selector:n,context:o}=s;if(t.matchesSelector(v,n)&&t.nodeContains(o,u)&&t.nodeContains(o,v)){const{listeners:e}=s;l.currentTarget=v;for(const[t,{capture:s,passive:n}]of e)s===r.capture&&n===r.passive&&t(l)}}v=t.parentNode(v)}}function f(e){return d(e,!0)}return s.document.createElement("div").addEventListener("test",null,{get capture(){return c.supportsOptions=!0},get passive(){return c.supportsPassive=!0}}),s.events=c,c}};
//# sourceMappingURL=events.prod.js.map